import tensorflow as tf
from PIL import Image

IMAGE_HEIGHT = 128
IMAGE_WIDTH = 32
IMAGE_DEPTH = 3

model = tf.keras.models.load_model('CNN_multi_entropy_v1.model')

def load_image(image_path):
    img = tf.io.read_file(image_path)
    img = tf.image.decode_jpeg(img, channels = IMAGE_DEPTH)
    img = tf.image.resize(img, (IMAGE_HEIGHT, IMAGE_WIDTH))
    img = tf.cast(img, tf.float32)
    img = tf.divide(img,255.0)
    return img

def predict():
    img = tf.data.Dataset.from_tensor_slices((['testimg.png']))
    img = img.map(load_image)
    theimg = img.batch(1)
    predictions = model.predict(x=theimg)
    result = (list(map('{:%}'.format,predictions[0])))
    return result
