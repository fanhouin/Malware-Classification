import sys
import os
import csv

path = 'C:/Users/Fan/Desktop/malware_zip'

label = {'Adware': 1, 
        'Backdoor': 2,
        'Ransom' : 3,
        'Trojan' : 4,
        'Worm' : 5}

table = [['Name','Adware','Backdoor','Ransom','Trojan','Worm']]

for root, dirs, files in os.walk(path, topdown=False):
    for name in files:
        name_arr = name.split('_')

        row = [name,'0','0','0','0','0']
        
        for label_name in name_arr:
            if(len(label_name) <= 15):
                row[label[label_name]] = '1'
        
        table.append(row)
        
with open(path + 'output.csv', 'w', newline='') as csvfile:
  writer = csv.writer(csvfile)
  writer.writerows(table)