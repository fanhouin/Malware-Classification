import sys
import os
import shutil

path = 'D:/malware_image/malware/'

for root, dirs, files in os.walk(path, topdown=False):
    for name in files:
        name_arr = name.split('_')
        md5_index =  len(name_arr) - 1
        
        folder_name = name.replace('_' + name_arr[md5_index], '')

        if not os.path.isdir(path + folder_name):
            os.mkdir(path + folder_name)

        os.system('mv '+ path + name +' '+ path + folder_name + '/' + name) 